#!/bin/bash

# From http://github.com/Daenyth/dotfiles/blob/b2de423b20b0fa29ccd8776c8a74a79ae9dc2893/.bashprompt#L37
# vim: fdm=marker ts=8 et:
####
# Modified from tldp.org by Daenyth
##

# Define Colors {{{
red='\[\e[0;31m\]'
RED='\[\e[1;31m\]'
blue='\[\e[0;34m\]'
BLUE='\[\e[1;34m\]'
cyan='\[\e[0;36m\]'
CYAN='\[\e[1;36m\]'
NC='\[\e[0m\]' # No Color
black='\[\e[0;30m\]'
BLACK='\[\e[1;30m\]'
green='\[\e[0;32m\]'
GREEN='\[\e[1;32m\]'
yellow='\[\e[0;33m\]'
YELLOW='\[\e[1;33m\]'
magenta='\[\e[0;35m\]'
MAGENTA='\[\e[1;35m\]'
white='\[\e[0;37m\]'
WHITE='\[\e[1;37m\]'
# }}}


# ssh_conn() -- return 1 if connected locally, 0 otherwise {{{
function ssh_conn() {
  if [[ -n "$SSH_CLIENT" || -n "$SSH2_CLIENT" ]]; then
   echo "$RED"
  fi
  echo "$BLUE"
}
# }}}

# root_privs() -- return 1 if not root, 0 if root {{{
function root_privs() {
  PRIV=1
  if [ `/usr/bin/id -u` -eq 0 ]; then
    PRIV=0
  fi
  return $PRIV
}
# }}}

if root_privs ; then
USRHILIGHT="$red"
  PWDHILIGHT="$NC"
else
PWDHILIGHT="$green"
  USRHILIGHT="$CYAN"
fi

prompt_type="2linebox"
case $prompt_type in
        2linebox)
                PS1="\n${cyan}╔═${WHITE}[ ${NC}\A${WHITE} ]${cyan}═${WHITE}[ ${NC}\u$(ssh_conn)@${NC}\h${WHITE} ]${cyan}═${WHITE}[ ${PWDHILIGHT}\w ${WHITE}]\n${cyan}╚═>${NC} "
                ;;
        nocolor)
                PS1='\u@\h \W \$ '
                ;;
        *)
                PS1="\u$(ssh_conn)@${NC}\h ${PWDHILIGHT}\W${NC} ${USRHILIGHT}\\\$${NC} "
                ;;
esac

unset prompt_type
unset -f ssh_conn
unset -f root_privs
export PS1
